<section class="content blog">
  <header>
    <h2><a href="<%= blog_url %>">The Deev-elopment Blog</a></h2>
  </header>

  <article class="post">

      <h3 class="title">
        <a href="<%= @post %>"><%= @post.title %></a>
      </h3>


      <figure>
        <img src="<%= @post.image_url %>">
      </figure>

      <% ps = @post.body.split("\n") %>

      <% ps.each do |p| %>
        <p><%= p%></p>
      <% end %>

    <br>
    <aside>posted by
      <em><%= @post.author.username %></em> at
      <time><%= @post.created_at%></time>
    </aside>
  </article>

  <% if user_signed_in? && current_user.admin %>
    <%= link_to "Edit this post", edit_post_url(@post) %>
  <% end %>

  <section id="comments">
    <h4>Comments</h4>

    <form action="<%= post_comments_url(@post) %>" method="post">
      <input type="hidden" name="authenticity_token"
        value="<%=form_authenticity_token%>">
        <input type="hidden" name="comment[parent_id]" value="<%= nil %>">
      <label>New Comment
        <input type="text" placeholder="Comment here..." name="comment[body]">
      </label>
      <input type="submit" value="Submit">
    </form>


    <ul>
      <% @post.comments.each do |comment| %>
        <% next if comment.parent_id %>
        <%= render partial: "comments/show", locals: { comment: comment } %>
      <% end %>
    </ul>
  </section>
</section>